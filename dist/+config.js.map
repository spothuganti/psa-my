{"version":3,"file":"+config.js","sources":["../src/utils/tsx-workaround.ts","../src/integration/ssrEffect.ts","../src/+config.ts"],"sourcesContent":["// This is a workaround for\r\n// * https://github.com/esbuild-kit/tsx/issues/113\r\n// * https://github.com/vuejs/core/issues/8303\r\n// Without this, when running vike-vue with tsx (for example when scaffolding a\r\n// Vue+Express project with Bati), querying the server will fail with the\r\n// following error:\r\n//     [vike][request(1)] HTTP request: /\r\n//     [vite][request(1)] __name is not defined\r\n//     [vite][request(1)] __name is not defined\r\n//     [vite][request(1)] __name is not defined\r\n//     [vite][request(1)] Error when evaluating SSR module virtual:vike:importPageCode:server:/pages/index: failed to import \"/pages/index/+Page.vue\"\r\n//     |- ReferenceError: __name is not defined\r\nconst globalName = (target: Object, value: string) =>\r\n  Object.defineProperty(target, 'name', {\r\n    value,\r\n    configurable: true,\r\n  })\r\n;(globalThis as any).__name = globalName\r\n","export { ssrEffect }\r\n\r\nimport type { ConfigEffect } from 'vike/types'\r\n\r\nfunction ssrEffect({ configDefinedAt, configValue }: Parameters<ConfigEffect>[0]): ReturnType<ConfigEffect> {\r\n  if (typeof configValue !== 'boolean') throw new Error(`${configDefinedAt} should be a boolean`)\r\n  const env = {\r\n    // Always load on the client-side.\r\n    client: true,\r\n    // When the SSR flag is false, we want to render the page only on the client-side.\r\n    // We achieve this by loading `Page` only on the client-side: when onRenderHtml()\r\n    // gets a `Page` value that is undefined it skip server-side rendering.\r\n    server: configValue !== false,\r\n  }\r\n  return {\r\n    meta: {\r\n      Page: { env },\r\n    },\r\n  }\r\n}\r\n","export { config as default }\r\n\r\nimport type { Config } from 'vike/types'\r\nimport './utils/tsx-workaround.js'\r\nimport { ssrEffect } from './integration/ssrEffect.js'\r\n\r\nconst config = {\r\n  name: 'vike-vue',\r\n  require: {\r\n    vike: '>=0.4.191',\r\n  },\r\n\r\n  // https://vike.dev/onRenderHtml\r\n  onRenderHtml: 'import:vike-vue/__internal/integration/onRenderHtml:onRenderHtml',\r\n  // https://vike.dev/onRenderClient\r\n  onRenderClient: 'import:vike-vue/__internal/integration/onRenderClient:onRenderClient',\r\n\r\n  // https://vike.dev/passToClient\r\n  // It is a cumulative config option, so a web app using vike-vue can extend\r\n  // this list.\r\n  passToClient: ['fromHtmlRenderer', '_configFromHook'],\r\n\r\n  // https://vike.dev/clientRouting\r\n  clientRouting: true,\r\n  hydrationCanBeAborted: true,\r\n  // https://vike.dev/meta\r\n  meta: {\r\n    Head: {\r\n      env: { server: true },\r\n      cumulative: true,\r\n    },\r\n    Layout: {\r\n      env: { server: true, client: true },\r\n      cumulative: true,\r\n    },\r\n    title: {\r\n      env: { server: true, client: true },\r\n    },\r\n    description: {\r\n      env: { server: true },\r\n    },\r\n    image: {\r\n      env: { server: true },\r\n    },\r\n    viewport: {\r\n      env: { server: true },\r\n    },\r\n    favicon: {\r\n      env: { server: true },\r\n      global: true,\r\n    },\r\n    lang: {\r\n      env: { server: true, client: true },\r\n    },\r\n    ssr: {\r\n      env: { config: true },\r\n      effect: ssrEffect,\r\n    },\r\n    stream: {\r\n      env: { server: true },\r\n    },\r\n    onCreateApp: {\r\n      env: { server: true, client: true },\r\n      cumulative: true,\r\n    },\r\n    onBeforeRenderHtml: {\r\n      env: { server: true },\r\n      cumulative: true,\r\n    },\r\n    onAfterRenderHtml: {\r\n      env: { server: true },\r\n      cumulative: true,\r\n    },\r\n    onBeforeRenderClient: {\r\n      env: { server: false, client: true },\r\n      cumulative: true,\r\n    },\r\n    onAfterRenderClient: {\r\n      env: { server: false, client: true },\r\n      cumulative: true,\r\n    },\r\n    bodyHtmlBegin: {\r\n      env: { server: true },\r\n      cumulative: true,\r\n      global: true,\r\n    },\r\n    bodyHtmlEnd: {\r\n      env: { server: true },\r\n      cumulative: true,\r\n      global: true,\r\n    },\r\n    htmlAttributes: {\r\n      env: { server: true },\r\n      global: true,\r\n      cumulative: true, // for Vike extensions\r\n    },\r\n    bodyAttributes: {\r\n      env: { server: true },\r\n      global: true,\r\n      cumulative: true, // for Vike extensions\r\n    },\r\n  },\r\n} satisfies Config\r\n\r\n/* Doesn't work: rollup removes these imports\r\nimport './types/Config.js'\r\nimport './types/PageContext.js'\r\n*/\r\n// Trick to ensure Rollup doesn't remove the imports\r\nexport type { __FakeExport_Config } from './types/Config.js'\r\nexport type { __FakeExport_PageContext } from './types/PageContext.js'\r\n"],"names":[],"mappings":"AAYA,MAAM,aAAa,CAAC,QAAgB,UAClC,OAAO,eAAe,QAAQ,QAAQ;AAAA,EACpC;AAAA,EACA,cAAc;AAChB,CAAC;AACD,WAAmB,SAAS;ACb9B,SAAS,UAAU,EAAE,iBAAiB,eAAsE;AACtG,MAAA,OAAO,gBAAgB,UAAW,OAAM,IAAI,MAAM,GAAG,eAAe,sBAAsB;AAC9F,QAAM,MAAM;AAAA;AAAA,IAEV,QAAQ;AAAA;AAAA;AAAA;AAAA,IAIR,QAAQ,gBAAgB;AAAA,EAAA;AAEnB,SAAA;AAAA,IACL,MAAM;AAAA,MACJ,MAAM,EAAE,IAAI;AAAA,IACd;AAAA,EAAA;AAEJ;ACbA,MAAM,SAAS;AAAA,EACb,MAAM;AAAA,EACN,SAAS;AAAA,IACP,MAAM;AAAA,EACR;AAAA;AAAA,EAGA,cAAc;AAAA;AAAA,EAEd,gBAAgB;AAAA;AAAA;AAAA;AAAA,EAKhB,cAAc,CAAC,oBAAoB,iBAAiB;AAAA;AAAA,EAGpD,eAAe;AAAA,EACf,uBAAuB;AAAA;AAAA,EAEvB,MAAM;AAAA,IACJ,MAAM;AAAA,MACJ,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,YAAY;AAAA,IACd;AAAA,IACA,QAAQ;AAAA,MACN,KAAK,EAAE,QAAQ,MAAM,QAAQ,KAAK;AAAA,MAClC,YAAY;AAAA,IACd;AAAA,IACA,OAAO;AAAA,MACL,KAAK,EAAE,QAAQ,MAAM,QAAQ,KAAK;AAAA,IACpC;AAAA,IACA,aAAa;AAAA,MACX,KAAK,EAAE,QAAQ,KAAK;AAAA,IACtB;AAAA,IACA,OAAO;AAAA,MACL,KAAK,EAAE,QAAQ,KAAK;AAAA,IACtB;AAAA,IACA,UAAU;AAAA,MACR,KAAK,EAAE,QAAQ,KAAK;AAAA,IACtB;AAAA,IACA,SAAS;AAAA,MACP,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,QAAQ;AAAA,IACV;AAAA,IACA,MAAM;AAAA,MACJ,KAAK,EAAE,QAAQ,MAAM,QAAQ,KAAK;AAAA,IACpC;AAAA,IACA,KAAK;AAAA,MACH,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,QAAQ;AAAA,IACV;AAAA,IACA,QAAQ;AAAA,MACN,KAAK,EAAE,QAAQ,KAAK;AAAA,IACtB;AAAA,IACA,aAAa;AAAA,MACX,KAAK,EAAE,QAAQ,MAAM,QAAQ,KAAK;AAAA,MAClC,YAAY;AAAA,IACd;AAAA,IACA,oBAAoB;AAAA,MAClB,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,YAAY;AAAA,IACd;AAAA,IACA,mBAAmB;AAAA,MACjB,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,YAAY;AAAA,IACd;AAAA,IACA,sBAAsB;AAAA,MACpB,KAAK,EAAE,QAAQ,OAAO,QAAQ,KAAK;AAAA,MACnC,YAAY;AAAA,IACd;AAAA,IACA,qBAAqB;AAAA,MACnB,KAAK,EAAE,QAAQ,OAAO,QAAQ,KAAK;AAAA,MACnC,YAAY;AAAA,IACd;AAAA,IACA,eAAe;AAAA,MACb,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,YAAY;AAAA,MACZ,QAAQ;AAAA,IACV;AAAA,IACA,aAAa;AAAA,MACX,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,YAAY;AAAA,MACZ,QAAQ;AAAA,IACV;AAAA,IACA,gBAAgB;AAAA,MACd,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,QAAQ;AAAA,MACR,YAAY;AAAA;AAAA,IACd;AAAA,IACA,gBAAgB;AAAA,MACd,KAAK,EAAE,QAAQ,KAAK;AAAA,MACpB,QAAQ;AAAA,MACR,YAAY;AAAA;AAAA,IACd;AAAA,EACF;AACF;"}